{{$data := json (getenv "SYNC_BLOCK_JSON" (getv /codesync/sync/json-conf "{"syncblock":[{"source":"/project-a-target","target":"/project-a-target","owner_and_group":"root:root","access_modes":"755","interval":"2"},{"source":"/project-b-source","target":"/project-b-target","owner_and_group":"root:root","access_modes":"755","interval":"2"}}]}'")}}
{{range $data.syncblock}}
   source= {{.source}}
   target= {{.target}}
   owner_and_group= {{.owner_and_group}}
   access_modes= {{.access_modes}}
   interval={{.interval}}
   
   while inotifywait -r -e modify,create,delete $source ; do
      rsync -avz $source $target
      chmod -R $target/
      chown -hR $target/
   done

{{end}}
